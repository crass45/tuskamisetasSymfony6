{# templates/admin/layout.html.twig #}

{# 1. Herencia (sin cambios) #}
{% extends '@SonataAdmin/standard_layout.html.twig' %}

{# 2. Estilos (sin cambios) #}
{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{# 3. Bloque de contenido de la barra lateral con la ruta final corregida #}
{% block side_bar_after_nav_content %}
    <div style="text-align: left; padding-left: 5px;">
        <p>
            <a href="{{ path('app_home') }}" rel="noreferrer" target="_blank" style="color: #b8c7ce;">
                <i class="fas fa-globe fa-fw"></i> Visitar TusKamisetas.com
            </a>
        </p>

        {% if is_granted('ROLE_SUPER_ADMIN') %}
            <p>
                {# AHORA: Usamos la ruta correcta que me has indicado #}
                <a href="{{ path('app_admin_supplier_order_request') }}" style="color: #b8c7ce;">
                    <i class="fas fa-truck fa-fw"></i> Pedir a proveedor
                </a>
            </p>
        {% endif %}
    </div>
{% endblock %}

{# 4. Javascripts (sin cambios) #}
{% block javascripts %}
    {{ parent() }}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    {# 1. Cargamos el script de TinyMCE desde su CDN oficial con TU API KEY #}
    <script src="https://cdn.tiny.cloud/1/lnph1kzh6dl773aimwpg1q0rcwyuxu4oau7fsupn3745i6ut/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    {# 2. Inicializamos el editor en cualquier textarea con la clase "tinymce" #}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Añadimos un pequeño retraso para asegurar que Sonata ha renderizado el formulario
            setTimeout(function() {
                tinymce.init({
                    selector: 'textarea.tinymce', // Elige todos los textareas con la clase "tinymce"
                    language: 'es',
                    height: 500,
                    plugins: 'advlist autolink lists link image charmap preview anchor searchreplace visualblocks code fullscreen insertdatetime media table help wordcount',
                    toolbar: 'undo redo | blocks | bold italic forecolor backcolor | ' +
                        'alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | ' +
                        'link image media table | removeformat | code fullscreen preview | help',
                    menubar: 'file edit view insert format tools table help',
                });
            }, 150); // Un retraso de 150ms es muy seguro
        });
    </script>

{% endblock %}