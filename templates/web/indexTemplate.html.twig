{% extends "base.html.twig" %}

{% block baseBody %}

    {% block slider %}
    {% endblock %}

    <section>
        <div class="row">
            {% block contenedor %}
                <div class="wrapper">
                    <nav id="sidebar">
                        {% block menuLateral %}
                            {# ========================================================== #}
                            {# INICIO DE LA CORRECCIÓN: Se incluye el nuevo panel de filtros #}
                            {# ========================================================== #}
                            {% include 'web/partials/_menu_filtros.html.twig' %}
                            {# ========================================================== #}
                            {# FIN DE LA CORRECCIÓN #}
                            {# ========================================================== #}
                        {% endblock %}
                    </nav>

                    <div id="content" style="width: 100%">
                        <div id="tkmContainer">
                            <div id="sidebarCollapse" class="navbar-header visible-xs" style="border-radius: 5px; background-color: black; color: white; padding: 10px;vertical-align: middle; cursor: pointer;position: -webkit-sticky; /* Safari */position: sticky; top: 5px; z-index: 999; margin-bottom: 15px">
                                <div  class="navbar-btn" style="width: 20px; height: 20px; display: inline-block; background-image: url({{ asset('images/refine.png') }}); background-repeat: no-repeat; background-size: 100% 100%; margin: 0;padding: 0; vertical-align: middle ">
                                </div>
                                <span style="margin-left: 10px">{% trans %}Refina tu búsqueda{% endtrans %}</span>
                            </div>

                            {% block cuerpo %}
                                {# Aquí es donde se renderizará el contenido principal de la página (la parrilla de productos, etc.) #}
                            {% endblock %}

                            {% if vistos is defined and vistos|length > 0 %}
                                <div class="row">
                                    <div class="recommended_items carousel"><!--recommended_items-->
                                        <h2 class="title text-center">{% trans %}ÚLTIMOS PRODUCTOS VISTOS{% endtrans %}</h2>
                                        <div>
                                            <div>
                                                {% for producto in vistos %}
                                                    {# MIGRACIÓN: Se actualiza la ruta de la plantilla incluida #}
                                                    {% include 'web/partials/_ultimos_vistos_grid.html.twig' %}
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div><!--/recommended_items-->
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endblock contenedor %}
        </div>
    </section>
{% endblock baseBody %}