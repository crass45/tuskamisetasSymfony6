{% extends "base.html.twig" %}

{% block title %}¡Pago Realizado con Éxito!{% endblock %}
{% block metaDescription %}El proceso de compra para tu pedido ha finalizado correctamente.{% endblock %}

{% block baseBody %}
    <div class="col-lg-12 tkmPading">
        <div style="padding: 40px 15px; text-align: center;">
            <i class="fa fa-check-circle" style="font-size: 80px; color: #5cb85c;"></i>
            <h1 class="titulo text-center" style="margin-top: 20px;">¡GRACIAS POR TU COMPRA!</h1>
            <br>
            <p class="lead">Enhorabuena, tu pago se ha realizado correctamente.</p>
            <p>Hemos registrado tu pedido con el número <strong>{{ pedido }}</strong> y recibirás un email de confirmación con todos los detalles.</p>
            <p>Te mantendremos informado sobre su estado en todo momento.</p>
            <br>
            <p>Si tienes cualquier duda, no dudes en ponerte en contacto con nosotros escribiéndonos un email a <strong>info@tuskamisetas.com</strong></p>
            <br>
            <br>
            <div style="text-align: center; border-top: 1px dashed #ccc; padding-top: 30px;">
                <a href="{{ path('app_home', {'_locale': app.request.locale}) }}" target="_parent"
                   style="background-color: #ff9000" class="button">
                    Volver a la tienda
                </a>
            </div>
        </div>
    </div>

    {# Google Analytics Purchase Event #}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            {% if transaccion is defined and items is defined %}
            if (typeof gtag === 'function') {
                gtag('event', 'purchase', {
                    'currency': 'EUR',
                    'transaction_id': '{{ transaccion.id }}',
                    'value': '{{ transaccion.revenue }}',
                    'affiliation': '{{ transaccion.affiliation }}',
                    'shipping': '{{ transaccion.shipping }}',
                    'tax': '{{ transaccion.tax }}',
                    'items': [
                        {% for item in items %}
                        {
                            'item_id': '{{ item.sku|e('js') }}',
                            'item_name': '{{ item.name|e('js') }}',
                            'item_category': '{{ item.category|e('js') }}',
                            'item_brand': '{{ item.brand|e('js') }}',
                            'item_variant': '{{ item.variant|e('js') }}',
                            'price': '{{ item.price }}',
                            'quantity': '{{ item.quantity }}'
                        }{% if not loop.last %},{% endif %}
                        {% endfor %}
                    ]
                });
            }
            {% endif %}
        });
    </script>
{% endblock %}
